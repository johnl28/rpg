class Monster extends Actor{type="MONSTER";hpLabel=null;lastAttack=0;attributes={hp:100,maxHp:100,speed:2,damage:2};constructor(t,e,i){super(t,e,i),this.container.interactive=!0,this.container.on("mousedown",(t=>{this.SelfClick()})),this.KeepAlive()}SelfClick(){gameInterface.TargetMob=this.virtualID,gameInterface.UpdateMobHud(this)}Die(){log("HEY I DIED!!!"),super.Die(),gameInterface.mobHud.hide()}__updateAttackState(){if(this.attacking||gameInstance.player.IsState("DIE")||this.IsState("DIE")||this.lastAttack>timestamp())return;let t=gameInstance.player.GetXY(),e=this.GetXY();distance(e.x,t.x,e.y,t.y)<this.GetAttr("range")&&(this.onStateComplete=()=>{this.attacking=!1,this.Attack(gameInstance.player),this.SetIDLE()},(e.x<t.x-50&&-1==this.direction||e.x>t.x&&1==this.direction)&&this.SetDirection(-1*this.direction),this.attacking=!0,this.lastAttack=timestamp()+(3-this.GetAttr("speed")),this.SetState("ATTACK",!1))}OnTickUpdate(t){super.OnTickUpdate(t),this.__updateAttackState()}Damage(t){this.IsState("DIE")||(super.Damage(t),gameInterface.UpdateMobHud(this))}KeepAlive(){if(this.IsState("IDLE"))return this.moveDirection.x=random(-1,2),this.moveDirection.y=random(-1,2),this.moveDirection.x!=this.direction&&this.moveDirection.x&&this.SetDirection(this.moveDirection.x),this.SetState("MOVE"),void setTimeout((()=>{this.KeepAlive()}),random(1e3,2e3));this.IsState("MOVE")&&this.SetIDLE(),setTimeout((()=>{this.KeepAlive()}),random(5e3,15e3))}}
