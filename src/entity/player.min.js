class Player extends Actor{type="PLAYER";resourceName="player";stateAnimations={IDLE:{animation:"adventurer-idle-2",speed:.15},ATTACK1:{animation:"adventurer-attack3",speed:.2},ATTACK2:{animation:"adventurer-attack2",speed:.2},ATTACK3:{animation:"adventurer-air-attack1",speed:.3,damage:10},MOVE:{animation:"adventurer-run",speed:.2},RUN:{animation:"adventurer-run3",speed:.25},TURN:{animation:"adventurer-idle2",speed:.12},HURT:{animation:"adventurer-hurt",speed:.12},DIE:{animation:"adventurer-die",speed:.12},IDLE2:{animation:"adventurer-idle",speed:.12},DRW:{animation:"adventurer-swrd-shte",speed:.15},CAST:{animation:"adventurer-cast-loop",speed:.2}};playTime=0;name="Test Name";empire="empire1";level=1;attributes={hp:100,maxHp:100,speed:2,damage:2};constructor(t,e,a){super(t,e,a),gameInterface.UpdateUI(this),this.lastInteract=this.playTime,this.container.interactive=!0,this.container.on("mousedown",(()=>this.SelfClick()))}SelfClick(){gameInterface.mobHud.hide(),this.attacking||this.IsState("IDLE2")||(this.onStateComplete=()=>this.SetState("IDLE2",!0),this.SetState("DRW",!1))}Spawn(t,e){super.Spawn(t,e),this.SetScale(.5),this.SetZ(e)}TranslateInput(t){switch(t){case"KeyA":case"KeyW":return-1;case"KeyD":case"KeyS":return 1}return 1}MoveX(t){if(this.IsState("DIE"))return;this.attacking=!1;let e=this.TranslateInput(t);this.direction!=e&&this.SetDirection(e),this.moveDirection.x=e,this.SetState("RUN")}MoveY(t){this.IsState("DIE")||(this.attacking=!1,this.moveDirection.y=this.TranslateInput(t),this.SetState("MOVE"))}__updateState(){super.__updateState();let t=this.GetXY();$("#player-coor").text(`${t.x}x${t.y}`)}Damage(t){super.Damage(t),this.attacking=!1,gameInterface.UpdateUI(this)}Respawn(){if(!this.IsState("DIE"))return;let t=gameInstance.map;this.SetXY(t.basePosition.x,t.basePosition.y),this.SetIDLE(),this.SetAttr("hp",this.GetAttr("maxHp")),gameInterface.UpdateUI(this),gameInterface.ToggleDiedText()}Die(){this.onStateComplete=()=>{gameInterface.ToggleDiedText()},this.attacking=!1,this.SetState("DIE",!1)}__updateAttackState(){if(!this.attacking||this.IsState("DIE"))return;let t=gameInstance.map;for(let e in t.entities){let a=t.entities[e],i=a.GetXY(),s=this.GetXY();distance(s.x,i.x,s.y,i.y)>150||a.IsState("DIE")||this.Attack(a)}}KeyToAttackState(t){switch(t){case"Space":return"ATTACK2";case"Combo":return"ATTACK3"}return"ATTACK1"}AttackInput(t){if(this.attacking||this.IsState("DIE"))return;let e=this.KeyToAttackState(t);this.onStateComplete=()=>{this.__updateAttackState(),this.attacking=!1,!this.IsState("ATTACK3")&&Math.floor(101*Math.random())<50?this.AttackInput("Combo"):this.SetState("IDLE")},this.attacking=!0,this.SetState(e,!1)}}
